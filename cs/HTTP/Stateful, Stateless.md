# Stateful, Stateless

## 무상태 프로토콜을 지향한다(스테이스레스, stateless)
- 서버가 클라이언트의 상태를 보존하지 않는다
- **장점 :** 서버의 **확장성이 높음(스케일 아웃)**
- **단점 :** 클라이언트가 추가 데이터를 전송해야한다

<br>

## Stateful, Stateless 차이

### 상태유지, Stateful
- 상태유지 : 중간에 서버가 바뀌면 안된다
- 만약 중간에 다른 서버로 바뀐다면, 상태정보를 다른 서버에 미리 알려줘야 한다

### 무상태, Stateless
- 중간에 다른 서버로 바뀌어도 된다
- 갑자기 클라이언트 요청이 증가해도 서버를 대거 투입할 수 있다
- 무상태는 응답 서버를 쉽게 바꿀 수 있다 -> 무한한 서버 증설 가능
  -    🌟 상태 유지를 하지 않기 때문에 기존 상태를 관리하지 않아도 된다. 그래서 그냥 서버 증설 마구마구 하면 된다!

<br>

그림으로 보자...

<br>

- 클라이언트는 노트북 2개를 구매한다는 상태를 유지하고 있어야 한다
- 이렇게 되면 서버를 늘리기가 어렵다. 클라이언트A는 상태 유지를 위해 항상 서버 1과 통신해야한다

![스크린샷 2022-09-06 오후 3 31 28](https://user-images.githubusercontent.com/101084642/188562864-5dfafeba-ca45-458a-b6c7-a0af85f99427.png)


- 중간에 서버 1에 장애가 난다면?... 그야말로 문제다
- 클라이언트 A는 처음부터 결제를 다시해야한다. (서버가 상태 유지를 하고 있어야 하는데 장애가 생겨버렸기 때문에)

![스크린샷 2022-09-06 오후 3 32 36](https://user-images.githubusercontent.com/101084642/188563079-7662fe0c-7c93-4337-ab96-68f553c0367b.png)

- 반면에... 무상태인 경우 애초에 클라이언트에서 제품은 노트북이고, 수량은 2개! 즉 필요한 데이터를 담아서 보낸다

![스크린샷 2022-09-06 오후 3 39 33](https://user-images.githubusercontent.com/101084642/188564305-12b2ede0-4338-4b20-8508-1be7a4bf497d.png)

- 중간에 서버 1에서 장애가 발생한다면?
- 클라이언트A는 중계서버에서 그냥 서버2로 던져보인다
- 클라이언트가 필요한 정보를 다 던져버리기 때문에 서버2로 바꾸어도 상관이 없다

![스크린샷 2022-09-06 오후 3 42 42](https://user-images.githubusercontent.com/101084642/188564803-1dc26878-3a9e-4d6d-845c-1e784172b322.png)


<br>

### 📌 무상태 - stateless
#### 스케일 아웃 - 수평 확장 유리

- 위와 같은 특성으로 인해 무상태는 스케일 아웃(서버를 쫙 늘리는것, 수평확장)에 유리하다

<br>

### 📌 무상태 - 실무적 한계
- 무상태로 설계할 수 없는 경우가 있다
- 예를들어 로그인한 사용자가 로그인 상태를 유지해야하는 경우를 예로 들 수 있음
- 일반적으로 브라우저의 쿠키와 세션을 조합해서 상태를 유지하는 방법을 활용한다
- 하지만 이런 상태에서 세션 서버가 죽어버리면 전체적으로 로그인이 풀려버리는 등 한계는 여전히 있다
- 🌟 상태유지는 꼭 필요한 경우에만 최소한으로 사용해야 한다
- 또 다른 단점은 클라이언트에서 데이터를 더 많이 보내야 한다(제품은 노트북이고, 수량은 2개)
