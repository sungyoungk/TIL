# ğŸ“£ í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©í•  ê²½ìš° ë°œìƒí•˜ëŠ” ë¬¸ì œ
- í”„ë¡œí† íƒ€ì… ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆ ìš”ì²­ì‹œ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤
- ê·¸ëŸ°ë°, ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©í•  ë•ŒëŠ” ë™ì‘í•˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìƒê¸´ë‹¤

<br>

## ğŸ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì§ì ‘ ìš”ì²­í•  ê²½ìš°
- prototypeBean1 í´ë¼ì´ì–¸íŠ¸ê°€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìš”ì²­í•œë‹¤
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒˆë¡œ ìƒì„±í•´ì„œ ë°˜í™˜í•˜ê³ , count ê°’ì€ 0 ì´ë‹¤
- addCount() ë¡¤ í˜¸ì¶œí•˜ë©´, ì¹´ìš´íŠ¸ í•„ë“œê°€ 1ì´ ëœë‹¤

- ê°™ì€ ë°©ë²•ìœ¼ë¡œ prototypeBean2 í´ë¼ì´ì–¸íŠ¸ê°€ ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìš”ì²­í•˜ë©´...
- ì •í™•íˆ ê°™ì€ ë¡œì§ìœ¼ë¡œ ìƒˆë¡œìš´ ë¹ˆì´ ìƒì„±ë˜ê³  count í•„ë“œ ê°’ì´ 1ì´ ëœë‹¤
```java

public class SingletonWithPrototypeTest1 {

    @Test
    void prototypeFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);

        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        prototypeBean1.addcount();
        assertThat(prototypeBean1.getCount()).isEqualTo(1);

        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        prototypeBean2.addcount();
        assertThat(prototypeBean2.getCount()).isEqualTo(1);
    }
    
    @Scope("prototype")
    static class PrototypeBean {
        private int count = 0;

        public void addcount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init" + this);
        }

        @PreDestroy
        public void destroy() {
            System.out.println("prototypeBean.destroy");
        }
    }
}

```

<br>

## ğŸ” ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
- `ClientBean`ì€ ì‹±ê¸€í†¤ ë¹ˆìœ¼ë¡œ, ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ í†µí•´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì…ë°›ëŠ” ê²½ìš°


```java

   @Test
    void singletonClientUsePrototype(){

        AnnotationConfigApplicationContext ac =
                new AnnotationConfigApplicationContext(PrototypeBean.class, ClientBean.class);
        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        int count1 = clientBean1.logic();
        assertThat(count1).isEqualTo(1);

        ClientBean clientBean2 = ac.getBean(ClientBean.class);
        int count2 = clientBean2.logic();
        assertThat(count2).isEqualTo(2);
    }


    @Scope("singleton")
    static class ClientBean{
        private final PrototypeBean prototypeBean;  // ìƒì„±ì‹œì ì— ì£¼ì…ë˜ì–´ ìˆìŒ

       @Autowired
        public ClientBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addcount();
            int count = prototypeBean.getCount();
            return count;
        }
    }

    @Scope("prototype")
    static class PrototypeBean {
        private int count = 0;

        public void addcount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init" + this);
        }

        @PreDestroy
        public void destroy() {
            System.out.println("prototypeBean.destroy");
        }
    }
}

```

<br>

### 1ï¸âƒ£ ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©
- `clientBean`ì€ ì‹±ê¸€í†¤ì´ê³ , ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— ìƒì„±ë˜ê³ , ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ ë°œìƒ
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•˜ê³  `clientBean` ì— ë°˜í™˜í•œë‹¤. (count = 0)
- 'clientBean'ì´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ë‚´ë¶€ í•„ë“œì— ì£¼ì…ë°›ì•„ ì°¸ì¡°ê°’ì„ ë³´ê´€í•œë‹¤

<br>

### 2ï¸âƒ£ ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš© 2
- ì²«ë²ˆì§¸ í´ë¼ì´ì–¸íŠ¸ë¼ `clientBean`ì„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•˜ê³ , ì‹±ê¸€í†¤ì´ë¯€ë¡œ ê°™ì€ `clientBean`ì´ ë°˜í™˜ëœë‹¤
- `clientBean.logic()` ë§¤ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ `prototypeBean`ì˜ `addCount()`ë¥¼ í˜¸ì¶œí•´ì„œ í”„ë¡œí† íƒ€ì…ì˜ ë¹ˆ count ë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤(count = 1)

<br>

### 3ï¸âƒ£ ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©3
- ë‘ ë²ˆì§¸ í´ë¼ì´ì–¸íŠ¸ì—ì„œ `clientBean`í˜¸ì¶œí•˜ë©´ ì—­ì‹œ ê°™ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ê°€ ë°˜í™˜ëœë‹¤(ì‹±ê¸€í†¤)
- ê·¸ëŸ°ë°, ğŸŒŸ **clientBean ë‚´ë¶€ì˜ í”„ë¡œí† íƒ€ì… ë¹ˆì€ ì´ë¯¸ ë‚´ë¶€ ì£¼ì…ì´ ì™„ë£Œëœ ìƒíƒœì´ë‹¤ ì£¼ì… ì‹œì ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•´ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ë©´, ì‚¬ìš©í• ë•Œ ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ë˜ì§€ ì•ŠëŠ”ë‹¤(ì‹±ê¸€í†¤ì„ ë”°ë¼ê°„ë‹¤)**
- í´ë¼ì´ì–¸íŠ¸ê°€ `clientBeam.logic()` ì„ í˜¸ì¶œí•œë‹¤
- ì—­ì‹œ `prototypeBean`ì˜ `addCount()`ë¥¼ í˜¸ì¶œí•´ì„œ countë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤
- ì›ë˜ ì¹´ìš´íŠ¸ ê°’ì´ 1ì´ì˜€ìœ¼ë¯€ë¡œ (count = 2)

<br>

## ğŸ“š ì •ë¦¬
- ì‹±ê¸€í†¤ ë¹ˆì€ ìƒì„± ì‹œì ì—ë§Œ ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ë°›ê³ , í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì…ë°›ì•„ ë‚´ë¶€ í•„ë“œì— ì €ì¥í•˜ê³ ë‚˜ë©´ **ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ìœ ì§€ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒ**í•œë‹¤
- í•˜ì§€ë§Œ, í”„ë¡œí† íƒ€ì… ë¹ˆì€ ìƒì„± ì‹œì ë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ëŠ” íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆëŠ”ë° ìœ„ì˜ ê²½ìš° ì´ëŸ¬í•œ íŠ¹ì„±ì„ ì‚´ë¦¬ì§€ ëª»í•œë‹¤
- providerë¡œ ë¬¸ì œ í•´ê²° ê°€ëŠ¥!




