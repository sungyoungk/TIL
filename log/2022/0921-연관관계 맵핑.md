# ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„

## ê°ì²´ë¥´ë¥´ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§ í•  ê²½ìš° ë¬¸ì œì 
- ì°¸ì¡° ëŒ€ì‹ ì— ì™¸ë˜í‚¤ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 26 16](https://user-images.githubusercontent.com/101084642/191400426-3acf98bc-b7c0-4410-9d50-6146d143c204.png)

#### `ë¬¸ì œì `
- ì¡°íšŒì‹œ ì‹ë³„ìë¡œ ë‹¤ì‹œ ì¡°íšŒí•´ì•¼í•¨ìœ¼ë¡œ ê°ì²´ì§€í–¥ì  ë°©ë²•ì´ ì•„ë‹˜
- ë°ì´í„° ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë¸ë§ ë˜ì–´ ê°ì²´ì˜ í˜‘ë ¥ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤
- **ğŸ’¡ í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ë¡œ ì¡°ì¸ì„ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ë¥¼ ì°¾ëŠ”ë‹¤**
- **ğŸ’¡ê°ì²´ëŠ” ì°¸ì¡°ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ë¥¼ ì°¾ëŠ”ë‹¤**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 26 55](https://user-images.githubusercontent.com/101084642/191400508-ce9e5bf9-74c9-4f57-8f84-e337c9165d44.png)

<br>

## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„(ê°ì²´ì§€í–¥)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 29 59](https://user-images.githubusercontent.com/101084642/191400868-86dd503a-8c83-4db8-93c9-fd4f0586c46a.png)

- ê°ì²´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë¸ë§ì„ í•˜ë©´ **ì°¸ì¡°**ë¥¼ ì´ìš©í•˜ì—¬ ì—°ê´€ê´€ê³„ë¥¼ ì¡°íšŒí•œë‹¤
- í•˜ì§€ë§Œ, ì§€ê¸ˆì€ ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ë¡œ ë©¤ë²„ëŠ” íŒ€ì„ ì¡°íšŒí•  ìˆ˜ ìˆì§€ë§Œ íŒ€ì€ ë©¤ë²„ ì¡°íšŒë¥¼ í•˜ì§€ ëª»í•œë‹¤

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 30 42](https://user-images.githubusercontent.com/101084642/191400953-844335e7-6ac1-4f3f-8265-cab621f6fa2e.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 31 27](https://user-images.githubusercontent.com/101084642/191401016-62e79035-7778-4c48-bae6-9fe0d5ecb2b2.png)

<br>

## ì–‘ë°©í–¥ ë§¤í•‘ê³¼ ì—°ê´€ê´€ê³„ ì£¼ì¸

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 33 54](https://user-images.githubusercontent.com/101084642/191401351-bf180d3f-a602-45ce-b258-6e8f903fd3eb.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 34 21](https://user-images.githubusercontent.com/101084642/191401397-a43c260d-4ea0-48a5-85ca-4dfd27345090.png)

- íŒ€ ì—”í‹°í‹°ì— ì»¬ë ‰ì…˜ì„ ì¶”ê°€í•¨

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 34 34](https://user-images.githubusercontent.com/101084642/191401425-f3b84698-44ba-4723-92e4-312644100232.png)
- ë”°ë¼ì„œ, ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ ê°€ëŠ¥
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 35 01](https://user-images.githubusercontent.com/101084642/191401498-12a760af-68b2-478d-917b-89e0bb71ef0e.png)

<br>

## ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸

- ê°ì²´ì™€ í…Œì´ë¸”ì´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ë°©ë²•ì€ ë‹¤ë¦„
- ì‚¬ì‹¤ìƒ í…Œì´ë¸”ì€ ì™¸ë˜í‚¤ í•˜ë‚˜ë¥¼ ë‘ê³  ì™”ë‹¤ ê°”ë‹¤ê°€ ê°€ëŠ¥í•¨

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 43 34](https://user-images.githubusercontent.com/101084642/191402565-da5ab999-b698-408e-8eb8-53fb8761fa92.png)

```text
SELECT *
FROM MEMBER M
JOIN MEMBER M ON TEAM T.TEAM_ID = M.TEAMID

SELECT *
FROM TEAM T
JIN TEAM T ON M.TEAMID = T.TEAM_ID

```
- ê°ì²´ì˜ ê²½ìš° ì–‘ë°©í–¥ì€ ì‚¬ì‹¤ìƒ ë‹¨ë°©í–¥ì´ ì–‘ìª½ ë°©í–¥ìœ¼ë¡œ ë§µí•‘ì´ ë˜ì–´ìˆëŠ”ê²ƒì„
- ì´ë•Œ, ê°ì²´ì˜ ì£¼ì¸ì€ í…Œì´ë¸”ì—ì„œ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ìˆëŠ” ìª½ì´ ì„¤ê³„ìƒ ì¢‹ë‹¤
- ë§Œì•½ íŒ€ì„ ì£¼ì¸ìœ¼ë¡œ ì¡ìœ¼ë©´, íŒ€ì—ì„œ ë¬´ì—‡ì¸ê°€ ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ëŠ”ë° ë©¤ë²„ë¡œ ì¿¼ë¦¬ê°€ ë‚ ì•„ê°€ê³ ... ì„±ëŠ¥ìƒ ë¬¸ì œë„ ìˆë‹¤

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 42 40](https://user-images.githubusercontent.com/101084642/191402428-c4ba60aa-cc46-4b16-8c56-d1a995241b34.png)


![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-21 á„‹á…©á„Œá…¥á†« 11 40 57](https://user-images.githubusercontent.com/101084642/191402241-8f05e983-6e00-488a-9df9-4045ad4e9344.png)


## ì—°ê´€ê´€ê³„ ì£¼ì¸(ì–‘ë°©í–¥ ë§µí•‘ì¼ë•Œ)
- ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•œë‹¤ ì¦‰, ë“±ë¡, ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë‹¤
- ë‚˜ë¨¸ì§€ í•œ ìª½ì€ ì¡°íšŒë§Œ ê°€ëŠ¥í•˜ë‹¤
- ì£¼ì¸ì€ mappedBy ì†ì„± ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤

- ì£¼ì¸ì€ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ìˆëŠ” ìª½ìœ¼ë¡œ, ì—¬ê¸°ì„œëŠ” Memberê°€ ì£¼ì¸ì„
- N:1 ê´€ê³„ì—ì„œ N ì´ ì£¼ì¸ì´ ëœë‹¤


### ğŸ’¡ ì£¼ì˜
- ë”°ë¼ì„œ ì£¼ì¸ì¸ Member ê°€ ì•„ë‹Œ TEAM ìœ¼ë¡œ ë“±ë¡, ìˆ˜ì • ë“±ì„ í•´ì„œëŠ” ì•ˆëœë‹¤

`Member`
``` java
package helloJpa;

import javax.persistence.*;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.util.Date;

@Entity
public class Member {
    @Id @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @Column(name = "USERNAME")
    private String name;

//    @Column(name = "TEAM_ID")
//    private Long teamId;
    @ManyToOne
    @JoinColumn(name = "TEAM_ID")
    private Team team;


    public Team getTeam() {
        return team;
    }

    public void setTeam(Team team) {
        this.team = team;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

//    public Long getTeamId() {
//        return teamId;
//    }
//
//    public void setTeamId(Long teamId) {
//        this.teamId = teamId;
//    }
}
```


`Team`
```java

package helloJpa;

import javax.persistence.*;
import java.util.ArrayList;
import java.util.List;

@Entity
public class Team {
    @Id @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    private String name;

    @OneToMany(mappedBy = "team")
    private List<Member> members = new ArrayList<>();

    public List<Member> getMembers() {
        return members;
    }

    public void setMembers(List<Member> members) {
        this.members = members;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}

```

`jpa main`
```java
package helloJpa;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;
import java.util.List;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");

        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction();
        tx.begin();

        try{
        Team team = new Team();
        team.setName("TeamA");
        em.persist(team);

        Member member = new Member();
        member.setName("memberA");
        member.setTeam(team);
            em.persist(member);

            em.flush();
            em.clear();

            Member findMember = em.find(Member.class, member.getId());
            List<Member> findMembers = findMember.getTeam().getMembers();

            for(Member m : findMembers) {
                System.out.println("m = " + m.getName());
            }



            tx.commit();
        } catch (Exception e) {
            tx.rollback();
        } finally {
            em.close();
        }
        emf.close();
    }
}

```

<br>

## ì—°ê´€ ê´€ê³„ ë§µí•‘ì‹œ ì£¼ì˜ì‚¬í•­
#### ğŸ’¡ ì—°ê´€ê´€ê³„ ì£¼ì¸ì—ê²Œ ê°’ì„ ì…ë ¥í•˜ì‹œ ì•ŠëŠ” ì‹¤ìˆ˜!
- ì´ë ‡ê°œ í•´ì„œ DBë¥¼ í™•ì¸í•´ë³´ë©´ TEAM_ID ê°€ nullë¡œ ë˜ì–´ ìˆë‹¤(ê°’ì´ ë“¤ì–´ê°€ì§€ ì•ŠëŠ”ë‹¤)
- ê¼­ ì—°ê´€ê´€ê³„ ì£¼ì¸ì—ê²Œ ê°’ì„ ì…ë ¥í•´ì•¼ í•œë‹¤
```java

Team team = new Team();â€¨ team.setName("TeamA");â€¨ em.persist(team);â€¨
â€¨
Member member = new Member();â€¨ member.setName("member1");â€¨
â€¨
â€¨
//ì—­ë°©í–¥(ì£¼ì¸ì´ ì•„ë‹Œ ë°©í–¥)ë§Œ ì—°ê´€ê´€ê³„ ì„¤ì •â€¨ 
team.getMembers().add(member);â€¨
em.persist(member);â€¨
```

`ì—°ê´€ê´€ê³„ ì£¼ì¸ì— ê°’ ì„¤ì •`
```java
Team team = new Team();â€¨ team.setName("TeamA");â€¨ em.persist(team);â€¨
â€¨
Member member = new Member();â€¨ member.setName("member1");â€¨
â€¨
â€¨
team.getMembers().add(member); 
member.setTeam(team); //**â€¨ //ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì— ê°’ ì„¤ì •
em.persist(member);â€¨

```
<br>

### ğŸ”¥ ì–‘ë°©í–¥ ë§µí•‘ì‹œ ìˆœìˆ˜í•œ ê°ì²´ë¥¼ ê³ ë ¤í•˜ì—¬ í•­ìƒ ì–‘ìª½ ê°’ì„ ì…ë ¥í•´ì•¼ í•œë‹¤
```java

try{
        Member member = new Member();
        member.setName("memberA");
        em.persist(member);


        Team team = new Team();
        team.setName("TeamA");
            member.setTeam(team);
            team.getMembers().add(member);   -- ì–‘ìª½ì— ê°’ ì„¤ì •ì„ ë‹¤ í•´ë†“ì
            em.persist(team);

            Team findTeam = em.find(Team.class, team.getId());
            List<Member> members = findTeam.getMembers();

            System.out.println("=====");
            for(Member m : members) {
                System.out.println(" m = " + m.getName());
            }
            System.out.println("=====");

//        team.getMembers().add(member);

//            em.flush();
//            em.clear();

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
        } finally {
            em.close();
        }
        emf.close();
```

## í™•ì‹¤íˆ í•˜ê¸° ìœ„í•´ì„œ Member í´ë˜ìŠ¤ setter ì— ê°’ì„ ê°™ì´ ì„¤ì •í•´ë²„ë¦¬ëŠ”ê²ƒë„ ë°©ë²•!!
```java

@Entity
public class Member {
    @Id @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @ManyToOne
    @JoinColumn(name = "TEAM_ID")
    private Team team;
    
   public void setTeam(Team team) {
        
        this.team = team;
        team.getMembers().add(this);
    }

```


## ğŸ” 1:N ì—°ê´€ê´€ê³„
- DBëŠ” ì„¤ê³„ìƒ N ìª½ì—ì„œ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ê´€ë¦¬í•¨
- ëª¨ì¢…ì˜ ì´ìœ ë¡œ ê°ì²´ ì…ì¥ì—ì„œ 1 ìª½ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ë˜ê²Œ ì½”ë“œë¥¼ ì§ ë‹¤ë©´...
- ê°ì²´ì™€ í…Œì´ë¸”ì— ì°¨ì´ê°€ ìƒê²¨ë²„ë¦°ë‹¤. ê°ì²´ëŠ” 1ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ì§€ë§Œ,,, ì–´ì¨‹ë“  ì™¸ë˜í‚¤ëŠ” Ní…Œì´ë¸”ì— ìˆë‹¤ ì¦‰ ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ê²Œ ë˜ëŠ”ê²ƒì´ë‹¤
- ë”°ë¼ì„œ ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì™œë˜í‚¤ë¥¼ ê°€ì§€ê³  ìˆê¸°ë•Œë¬¸ë ˆ ë°”ë¡œ insert SQLì„ ì‹¤í–‰í•˜ì§€ ëª»í•˜ê³ , ì¶”ê°€ë¡œ Ní…Œì´ë¸”ì—ì„œ update ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ì•¼ í•œë‹¤
- @JoinColumn ì„ ê¼­ ì¨ì•¼í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¡°ì¸ í…Œì´ë¸” ë°©ì‹ì„ ì‚¬ìš©í•´ì„œ ì¤‘ê°„ í…Œì´ë¸”ì´ í•˜ë‚˜ ìƒê²¨ë²„ë¦°ë‹¤
- ì•„ë˜ ì½”ë“œë¥¼ ë³´ë©´ JoinColumn ì˜ ì™œë˜í‚¤ê°€ ë‹¤ë¥¸ í…Œì´ë¸”ì— ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤
```java
@Entity
public class Team {
    @Id @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    private String name;

    @OneToMany
    @JoinColumn(name ="TEAM_ID")  // 1ì´ ì£¼ì¸ì´ ë˜ì–´ì„œ ë‹¤ë¥¸ í…Œì´ë¸” ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•¨
    private List<Member> members = new ArrayList<>();
    
    ~~
    
    }

```

## ğŸ” 1:N ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„
- êµ³ì´... ì–‘ë°©í–¥ 1:Nì„ ì“°ê³ ì í•œë‹¤ë©´...
- ë§ˆì¹˜ ì—°ê´€ê´€ê³„ ì£¼ì¸ ì²˜ëŸ¼ ë˜‘ê°™ì´ @JoinColumnì„ ì‚¬ìš©í•œë‹¤ (ë‹¤ë¥¸ í…Œì´ë¸” ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì—)
- ëŒ€ì‹ , insertable = false, updatavle = false ë¥¼ ì¶”ê°€í•´ì„œ ì½ê¸°ì „ìš©ìœ¼ë¡œ í•œì •ì‹œí‚¤ë©´ ë§ˆì¹˜ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì²˜ëŸ¼ ì“¸ ìˆ˜ ìˆë‹¤

```java

@Entity
public class Member {  // Nìª½ì´ê³  ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹ˆë‹¤
    @Id @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @Column(name = "USERNAME")
    private String name;

    @ManyToOne
    @JoinColumn(name = "TEAM_ID", insertable = false, updatable = false) 
    private Team team;
}

'''

```java

@Entity
public class Team {
    @Id @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    private String name;

    @OneToMany
    @JoinColumn(name ="TEAM_ID")
    private List<Member> members = new ArrayList<>();

}
```


### ê²°ë¡ 
- ë‹¤ : 1 ì—°ê´€ê´€ê³„ë¥¼ ì“°ì. í•„ìš”í•˜ë©´ ë‹¤:1 ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ì“°ì
