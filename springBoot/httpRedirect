

## ğŸ” HTTP REDIRECT  <br>
- Spring Boot ì—ì„œ ì„ë² ë””ë“œ í†°ì¼“ ì„œë²„ë¥¼ ì´ìš©í•  ë•Œ ë””í´íŠ¸ ì„œë²„ë¡œ HTTP ë˜ëŠ” HTTPS ë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ”ë°, ì´ ë•Œ HTTP ë¡œ ì ‘ì†í•  ê²½ìš° HTTPS ë¡œ redirect ì‹œì¼œì£¼ëŠ” ë°©ë²• <br>
- Spring Boot 2.0 ë²„ì „ë¶€í„° ì•„ë˜ì™€ ê°™ì´ config íŒŒì¼ì„ ì‘ì„±í•˜ë©´ 80 í¬íŠ¸ë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ 433 í¬íŠ¸ë¡œ ì „í™˜ ê°€ëŠ¥ <br>

<br>
```java
package com.jane.backoffice.web.configs;

import org.apache.catalina.Context;
import org.apache.catalina.connector.Connector;
import org.apache.tomcat.util.descriptor.web.SecurityCollection;
import org.apache.tomcat.util.descriptor.web.SecurityConstraint;
import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.servlet.server.ServletWebServerFactory;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class HttpRedirectConfig {
  @Bean
  public ServletWebServerFactory servletContainer() {
    TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory() {
      @Override
      protected void postProcessContext(Context context) {
        SecurityConstraint securityConstraint = new SecurityConstraint();
        securityConstraint.setUserConstraint("CONFIDENTIAL");
        SecurityCollection collection = new SecurityCollection();
        collection.addPattern("/*");
        securityConstraint.addCollection(collection);
        context.addConstraint(securityConstraint);
      }
    };

    tomcat.addAdditionalTomcatConnectors(createSslConnector());
    return tomcat;
  }

  private Connector createSslConnector() {
    Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
    connector.setPort(80);
    connector.setScheme("http");
    connector.setSecure(false);
    connector.setRedirectPort(443);
    return connector;
  }
}
```

<br>
<br>

ì´ ë•Œ, ERR_TOO_MANY_REDIRECTS ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

ì´ëŠ” ë¦¬ë””ë ‰ì…˜ì´ ì„œë¡œ ì—°ê²°ë˜ì–´ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì—ì„œ ë¹„ë¡¯ë˜ëŠ”ë°,
ì˜ˆë¥¼ ë“¤ì–´ http://example.com ì€ https://example.com ë¡œ ë¦¬ë””ë ‰ì…˜ë˜ê³ 
https://example.com ì€ ë‹¤ì‹œ http://example.com ìœ¼ë¡œ ë¦¬ë””ë ‰ì…˜ë˜ì–´ì§€ëŠ” ê²ƒìœ¼ë¡œ,
ì´ í”„ë¡œì„¸ìŠ¤ëŠ” ì„œë²„ì— ì˜í•´ ì„¤ì •ëœ ë¦¬ë””ë ‰ì…˜ íšŸìˆ˜ì— ë„ë‹¬í•  ë•Œê¹Œì§€ ë¬´í•œ ë°˜ë³µ ë  ìˆ˜ ìˆìœ¼ë©°,
ì´ˆê³¼ë˜ë©´ ì„œë²„ëŠ” ë¦¬ë””ë ‰ì…˜ ì²˜ë¦¬ ì‹œë„ë¥¼ ì¤‘ì§€ë˜ê³ 
Apache ì—ì„œëŠ” ë¸Œë¼ìš°ì €ê°€ ì²˜ë¦¬í•˜ëŠ” ë¹„í•˜ì¸ë“œ ìë™ ë¦¬ë””ë ‰ì…˜ ëŒ€ì‹  í™”ë©´ì—ì„œ
"ì´ í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤" ë©”ì‹œì§€(ì‹¤ì œ ë¦¬ë””ë ‰ì…˜ í˜ì´ì§€)ë¥¼ ë³´ê³  ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

 

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ HTTP í—¤ë”ì— ë”ì´ìƒ ìœ„ì¹˜ ê°’ì´ ë³´ì´ì§€ ì•Šì„ ë•Œê¹Œì§€
URL ì„ ê³„ì† ë”°ë¥´ë¼ëŠ” ëª…ë ¹ì„ ì£¼ë©´ í•´ê²°ëœë‹¤.
<br>

tomcat:
  protocol_header: x-forwarded-proto
  remote_ip_header: x-forwarded-for

